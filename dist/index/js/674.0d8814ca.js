"use strict";(self["webpackChunkjoinstu_index_vue"]=self["webpackChunkjoinstu_index_vue"]||[]).push([[674],{3010:function(t,e,s){s.d(e,{Z:function(){return tt}});var a=s(3396),o=s(9242),i=s(7139);const r={class:"card",style:{"border-radius":"0px","border-width":"0px","border-top-width":"2px"}},n={class:"card-body",style:{"min-height":"30vh","max-height":"55vh"}},l={key:0},d=(0,a._)("div",{class:"spinner-border text-primary",style:{height:"2em","margin-left":"calc(50vw - 2em)"},role:"status"},null,-1),p=[d],u={key:1},m={style:{"margin-top":"1em","margin-bottom":"1em"}},c=(0,a._)("i",{class:"bi bi-chat-left",style:{"margin-right":"0.5em"}},null,-1),g={key:0,class:"btn-group",role:"group",style:{height:"2em"}},h={key:1,class:"btn-group",role:"group",style:{height:"2em"}},b=(0,a._)("button",{class:"btn btn-secondary",type:"button",disabled:"",style:{"margin-right":"1em","margin-bottom":"0px","margin-left":"1em","padding-top":"3px","padding-bottom":"3px","border-radius":"6px"}},"留言支持意見",-1),v=(0,a._)("button",{class:"btn btn-secondary",type:"button",disabled:"",style:{"margin-top":"0px","margin-right":"0px","margin-bottom":"0px","margin-left":"0px","padding-top":"3px","padding-bottom":"3px","border-radius":"6px"}},"留言其他意見",-1),y=[b,v],_={key:2},w=(0,a._)("div",{class:"alert alert-primary",role:"alert"},[(0,a._)("i",{class:"bi bi-exclamation-triangle",style:{"margin-right":"1em"}}),(0,a._)("strong",null,"請先登入再留言")],-1),x=[w],D={key:3},f=(0,a._)("div",{class:"spinner-border text-white",role:"status"},null,-1),k=[f],C={key:4,class:"container pb-2"},z={class:"row"},S={class:"col-md-6"},$=(0,a._)("h4",null,"支持意見",-1),L={class:"list-group overflow-auto",style:{"max-height":"40vh"}},U={class:"d-flex media"},P={class:"media-body"},Z={class:"d-flex media",style:{overflow:"visible"}},q={style:{overflow:"visible"},class:"media-body"},H={class:"row"},Y={class:"col-md-12"},j=(0,a._)("br",null,null,-1),E={class:"text-muted"},K={class:"col-md-6"},V=(0,a._)("h4",null,"其他意見",-1),W={class:"list-group overflow-auto",style:{"max-height":"40vh"}},A={class:"d-flex media"},B={class:"media-body"},F={class:"d-flex media",style:{overflow:"visible"}},G={style:{overflow:"visible"},class:"media-body"},I={class:"row"},J={class:"col-md-12"},M=(0,a._)("br",null,null,-1),N={class:"text-muted"};function O(t,e,s,d,b,v){return(0,a.wg)(),(0,a.iD)("div",r,[(0,a._)("div",n,[void 0==b.isLogin?((0,a.wg)(),(0,a.iD)("div",l,p)):1==b.isLogin?((0,a.wg)(),(0,a.iD)("div",u,[(0,a._)("div",m,[c,(0,a.wy)((0,a._)("input",{type:"text",placeholder:"留言...",style:{height:"2em",width:"25em"},required:"","onUpdate:modelValue":e[0]||(e[0]=t=>b.comment=t)},null,512),[[o.nr,b.comment]]),0==b.status.sendingComment?((0,a.wg)(),(0,a.iD)("div",g,[(0,a._)("button",{onClick:e[1]||(e[1]=(...t)=>v.supportComment&&v.supportComment(...t)),class:"btn btn-primary",type:"button",style:{"margin-right":"1em","margin-bottom":"0px","margin-left":"1em","padding-top":"3px","padding-bottom":"3px","border-radius":"6px"}},"留言支持意見"),(0,a._)("button",{onClick:e[2]||(e[2]=(...t)=>v.elseComment&&v.elseComment(...t)),class:"btn btn-primary",type:"button",style:{"margin-top":"0px","margin-right":"0px","margin-bottom":"0px","margin-left":"0px","padding-top":"3px","padding-bottom":"3px","border-radius":"6px"}},"留言其他意見")])):((0,a.wg)(),(0,a.iD)("div",h,y))])])):0==b.isLogin?((0,a.wg)(),(0,a.iD)("div",_,x)):(0,a.kq)("",!0),void 0==b.commentData?((0,a.wg)(),(0,a.iD)("div",D,k)):((0,a.wg)(),(0,a.iD)("div",C,[(0,a._)("div",z,[(0,a._)("div",S,[$,(0,a._)("ul",L,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(b.commentData.support,(t=>((0,a.wg)(),(0,a.iD)("li",{class:"list-group-item",style:{"margin-bottom":"6px"},key:t.author},[(0,a._)("div",U,[(0,a._)("div",P,[(0,a._)("div",Z,[(0,a._)("div",q,[(0,a._)("div",H,[(0,a._)("div",Y,[(0,a._)("p",null,[(0,a._)("strong",null,(0,i.zw)(t.author),1),(0,a.Uk)(" "+(0,i.zw)(t.contents)+" ",1),j,(0,a._)("small",E,(0,i.zw)(new Date(t.date).toLocaleString()),1)])])])])])])])])))),128))])]),(0,a._)("div",K,[V,(0,a._)("ul",W,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(b.commentData.else,(t=>((0,a.wg)(),(0,a.iD)("li",{class:"list-group-item",style:{"margin-bottom":"6px"},key:t.author},[(0,a._)("div",A,[(0,a._)("div",B,[(0,a._)("div",F,[(0,a._)("div",G,[(0,a._)("div",I,[(0,a._)("div",J,[(0,a._)("p",null,[(0,a._)("strong",null,(0,i.zw)(t.author),1),(0,a.Uk)(" "+(0,i.zw)(t.contents)+" ",1),M,(0,a._)("small",N,(0,i.zw)(new Date(t.date).toLocaleString()),1)])])])])])])])])))),128))])])])]))])])}var Q=s(9314),R={name:"commentsSec",props:["urlPrefix"],data(){return{commentData:void 0,comment:"",isLogin:void 0,status:{commentUpdate:!1,sendingComment:!1}}},methods:{getComments(){let t=null;Q.h.get(`${this.urlPrefix}/comments/${this.$route.params.id}`,{},(e=>{t=e.data;for(let s in t.support)Q.h.post("data/getUser",{id:t.support[s].author},(e=>{t.support[s].author=e.data.name,this.commentData=t,this.status.updating=!0,this.status.updating=!1}),(t=>{console.error(t)}));for(let s in t.else)Q.h.post("data/getUser",{id:t.else[s].author},(e=>{t.else[s].author=e.data.name,this.commentData=t,this.status.updating=!0,this.status.updating=!1}),(t=>{console.error(t)}));this.status.commentUpdate=!0,this.status.commentUpdate=!1}),(t=>{console.error(t)}))},supportComment(){this.status.sendingComment=!0,Q.h.post(`${this.urlPrefix}/commentSupport/${this.$route.params.id}`,{contents:this.comment},(()=>{this.getComments()}),(t=>{403==t.response.status?this.emitter.emit("callLoginShow"):401==t.response.status?alert("管理員不可參與！"):console.error(t)})),this.comment="",this.status.sendingComment=!1},elseComment(){this.status.sendingComment=!0,Q.h.post(`${this.urlPrefix}/commentElse/${this.$route.params.id}`,{contents:this.comment},(()=>{this.getComments()}),(t=>{401==t.response.status?alert("管理員不可參與！"):console.error(t)})),this.comment="",this.status.sendingComment=!1}},created(){this.getComments(),Q.h.post("accounts/status",{},(t=>{0==t.data.status?this.isLogin=!1:this.isLogin=!0}),(t=>{console.error(t)}))}},T=s(89);const X=(0,T.Z)(R,[["render",O]]);var tt=X},674:function(t,e,s){s.r(e),s.d(e,{default:function(){return F}});var a=s(3396),o=s(7139);const i={key:0},r=(0,a._)("div",{class:"spinner-border text-primary",style:{height:"2em","margin-left":"calc(50vw - 2em)"},role:"status"},null,-1),n=[r],l={key:1},d={key:0,style:{padding:"1em"}},p={style:{color:"var(--bs-gray-700)"}},u={class:"text-end",style:{"border-width":"44px"}},m={key:0},c=(0,a._)("span",null,"已附議",-1),g={style:{color:"var(--bs-blue)","font-size":"24px"}},h=(0,a._)("span",null,"(尚須",-1),b={style:{color:"var(--bs-blue)","font-size":"24px"}},v=(0,a._)("span",null,"份)",-1),y={key:1},_=(0,a._)("span",null,"已附議",-1),w={style:{color:"var(--bs-blue)","font-size":"24px"}},x=(0,a._)("span",null,"人",-1),D=(0,a._)("div",null,[(0,a._)("span",{style:{color:"var(--bs-blue)","font-size":"24px"}},"已達到目標50份")],-1),f=(0,a._)("span",null,"剩餘",-1),k={style:{color:"var(--bs-blue)","font-size":"24px"}},C=(0,a._)("span",null,"天",-1),z={style:{"max-width":"calc(100vw)","word-break":"break-all"}},S=(0,a._)("h4",null,"目的",-1),$={style:{"white-space":"pre-wrap"}},L=(0,a._)("h4",null,"簡介",-1),U={style:{"white-space":"pre-wrap"}},P={class:"text-center"},Z={key:1,class:"btn btn-secondary center",type:"button",disabled:""},q={key:2,class:"btn btn-secondary center",type:"button",disabled:""},H={key:3,class:"btn btn-primary center",type:"button",disabled:""},Y=(0,a._)("div",{class:"spinner-border text-white",role:"status"},null,-1),j=[Y];function E(t,e,s,r,Y,E){const K=(0,a.up)("commentSec");return(0,a.wg)(),(0,a.iD)(a.HY,null,[void 0==Y.cardData?((0,a.wg)(),(0,a.iD)("div",i,n)):((0,a.wg)(),(0,a.iD)("div",l,[0==Y.status.updating?((0,a.wg)(),(0,a.iD)("div",d,[(0,a._)("h3",null,(0,o.zw)(Y.cardData.title),1),(0,a._)("h6",p,[(0,a.Uk)("作者："),(0,a._)("span",null,(0,o.zw)(Y.cardData.proposer),1)]),(0,a._)("div",u,[Y.cardData.num<50?((0,a.wg)(),(0,a.iD)("div",m,[c,(0,a._)("span",g,(0,o.zw)(Y.cardData.num),1),h,(0,a._)("span",b,(0,o.zw)(50-Y.cardData.num),1),v])):((0,a.wg)(),(0,a.iD)("div",y,[(0,a._)("div",null,[_,(0,a._)("span",w,(0,o.zw)(Y.cardData.num),1),x]),D,(0,a._)("div",null,[f,(0,a._)("span",k,(0,o.zw)(30-((new Date).getDate()-new Date(Y.cardData.date).getDate())),1),C])]))]),(0,a._)("div",z,[S,(0,a._)("span",$,(0,o.zw)(Y.cardData.purpose),1),L,(0,a._)("span",U,(0,o.zw)(Y.cardData.details),1),(0,a._)("div",P,[0==Y.isSupported?((0,a.wg)(),(0,a.iD)("button",{key:0,class:"btn btn-primary center",type:"button",onClick:e[0]||(e[0]=(...t)=>E.support&&E.support(...t))},"我要附議")):1==Y.isSupported?((0,a.wg)(),(0,a.iD)("button",Z,"已附議")):"adm"==Y.isSupported?((0,a.wg)(),(0,a.iD)("button",q,"管理員不可參與")):((0,a.wg)(),(0,a.iD)("button",H,j))])])])):(0,a.kq)("",!0)])),(0,a.Wm)(K,{urlPrefix:"propose"})],64)}s(7658);var K=s(9314),V=s(3010),W={components:{commentSec:V.Z},name:"proposeDetails",data(){return{cardData:void 0,isSupported:void 0,status:{updating:!1}}},methods:{support(){K.h.post(`propose/support/${this.$route.params.id}`,{},(t=>{1==t.data.status?(this.isSupported=!0,this.getDetails()):this.isSupported=!0}),(t=>{403==t.response.status?this.emitter.emit("callLoginShow"):401==t.response.status?alert("管理員不可參與！"):console.error(t)}))},getDetails(){K.h.get(`propose/details/${this.$route.params.id}`,{},(t=>{if(null!=t.data){let e=t.data;K.h.post("data/getUser",{id:e.proposer},(t=>{e.proposer=t.data.name,this.cardData=e,this.$route.meta.title=e.title,document.title=this.$route.meta.title,this.status.updating=!0,this.status.updating=!1}),(t=>{console.error(t)}))}else this.$router.push({name:"Error404",params:{status:404}})}),(t=>{console.error(t)}))}},created(){this.getDetails(),K.h.get(`propose/supportStatus/${this.$route.params.id}`,{},(t=>{1==t.data.status?this.isSupported=!0:0==t.data.status&&(this.isSupported=!1)}),(t=>{403==t.response.status?this.isSupported=!1:401==t.response.status?this.isSupported="adm":console.error(t)}))}},A=s(89);const B=(0,A.Z)(W,[["render",E]]);var F=B}}]);
//# sourceMappingURL=674.0d8814ca.js.map