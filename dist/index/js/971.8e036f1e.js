"use strict";(self["webpackChunkjoinstu_index_vue"]=self["webpackChunkjoinstu_index_vue"]||[]).push([[971],{4564:function(t,e,s){s.d(e,{Z:function(){return tt}});var a=s(3396),i=s(9242),o=s(7139);const r={class:"card",style:{"border-radius":"0px","border-width":"0px","border-top-width":"2px"}},n={class:"card-body",style:{"min-height":"30vh","max-height":"55vh"}},l={key:0},d=(0,a._)("div",{class:"spinner-border text-primary",style:{height:"2em","margin-left":"calc(50vw - 2em)"},role:"status"},null,-1),p=[d],u={key:1},m={style:{"margin-top":"1em","margin-bottom":"1em"}},c=(0,a._)("i",{class:"bi bi-chat-left",style:{"margin-right":"0.5em"}},null,-1),g={key:0,class:"btn-group",role:"group",style:{height:"2em"}},h={key:1,class:"btn-group",role:"group",style:{height:"2em"}},b=(0,a._)("button",{class:"btn btn-secondary",type:"button",disabled:"",style:{"margin-right":"1em","margin-bottom":"0px","margin-left":"1em","padding-top":"3px","padding-bottom":"3px","border-radius":"6px"}},"留言支持意見",-1),y=(0,a._)("button",{class:"btn btn-secondary",type:"button",disabled:"",style:{"margin-top":"0px","margin-right":"0px","margin-bottom":"0px","margin-left":"0px","padding-top":"3px","padding-bottom":"3px","border-radius":"6px"}},"留言其他意見",-1),v=[b,y],w={key:2},_=(0,a._)("div",{class:"alert alert-primary",role:"alert"},[(0,a._)("i",{class:"bi bi-exclamation-triangle",style:{"margin-right":"1em"}}),(0,a._)("strong",null,"請先登入再留言")],-1),D=[_],x={key:3},k=(0,a._)("div",{class:"spinner-border text-white",role:"status"},null,-1),f=[k],C={key:4,class:"container pb-2"},z={class:"row"},S={class:"col-md-6"},$=(0,a._)("h4",null,"支持意見",-1),L={class:"list-group overflow-auto",style:{"max-height":"40vh"}},U={class:"d-flex media"},q={class:"media-body"},P={class:"d-flex media",style:{overflow:"visible"}},Z={style:{overflow:"visible"},class:"media-body"},H={class:"row"},Y={class:"col-md-12"},j=(0,a._)("br",null,null,-1),E={class:"text-muted"},K={class:"col-md-6"},V=(0,a._)("h4",null,"其他意見",-1),W={class:"list-group overflow-auto",style:{"max-height":"40vh"}},A={class:"d-flex media"},B={class:"media-body"},F={class:"d-flex media",style:{overflow:"visible"}},G={style:{overflow:"visible"},class:"media-body"},I={class:"row"},J={class:"col-md-12"},M=(0,a._)("br",null,null,-1),N={class:"text-muted"};function O(t,e,s,d,b,y){return(0,a.wg)(),(0,a.iD)("div",r,[(0,a._)("div",n,[void 0==b.isLogin?((0,a.wg)(),(0,a.iD)("div",l,p)):1==b.isLogin?((0,a.wg)(),(0,a.iD)("div",u,[(0,a._)("div",m,[c,(0,a.wy)((0,a._)("input",{type:"text",placeholder:"留言...",style:{height:"2em",width:"25em"},required:"","onUpdate:modelValue":e[0]||(e[0]=t=>b.comment=t)},null,512),[[i.nr,b.comment]]),0==b.status.sendingComment?((0,a.wg)(),(0,a.iD)("div",g,[(0,a._)("button",{onClick:e[1]||(e[1]=(...t)=>y.supportComment&&y.supportComment(...t)),class:"btn btn-primary",type:"button",style:{"margin-right":"1em","margin-bottom":"0px","margin-left":"1em","padding-top":"3px","padding-bottom":"3px","border-radius":"6px"}},"留言支持意見"),(0,a._)("button",{onClick:e[2]||(e[2]=(...t)=>y.elseComment&&y.elseComment(...t)),class:"btn btn-primary",type:"button",style:{"margin-top":"0px","margin-right":"0px","margin-bottom":"0px","margin-left":"0px","padding-top":"3px","padding-bottom":"3px","border-radius":"6px"}},"留言其他意見")])):((0,a.wg)(),(0,a.iD)("div",h,v))])])):0==b.isLogin?((0,a.wg)(),(0,a.iD)("div",w,D)):(0,a.kq)("",!0),void 0==b.commentData?((0,a.wg)(),(0,a.iD)("div",x,f)):((0,a.wg)(),(0,a.iD)("div",C,[(0,a._)("div",z,[(0,a._)("div",S,[$,(0,a._)("ul",L,[b.status.commentUpdate?(0,a.kq)("",!0):((0,a.wg)(!0),(0,a.iD)(a.HY,{key:0},(0,a.Ko)(b.commentData.support,(t=>((0,a.wg)(),(0,a.iD)("li",{class:"list-group-item",style:{"margin-bottom":"6px"},key:t.id},[(0,a._)("div",U,[(0,a._)("div",q,[(0,a._)("div",P,[(0,a._)("div",Z,[(0,a._)("div",H,[(0,a._)("div",Y,[(0,a._)("p",null,[(0,a._)("strong",null,(0,o.zw)(t.author),1),(0,a.Uk)(" "+(0,o.zw)(t.contents)+" ",1),j,(0,a._)("small",E,(0,o.zw)(new Date(t.date).toLocaleString()),1)])])])])])])])])))),128))])]),(0,a._)("div",K,[V,(0,a._)("ul",W,[b.status.updating?(0,a.kq)("",!0):((0,a.wg)(!0),(0,a.iD)(a.HY,{key:0},(0,a.Ko)(b.commentData.else,(t=>((0,a.wg)(),(0,a.iD)("li",{class:"list-group-item",style:{"margin-bottom":"6px"},key:t.id},[(0,a._)("div",A,[(0,a._)("div",B,[(0,a._)("div",F,[(0,a._)("div",G,[(0,a._)("div",I,[(0,a._)("div",J,[(0,a._)("p",null,[(0,a._)("strong",null,(0,o.zw)(t.author),1),(0,a.Uk)(" "+(0,o.zw)(t.contents)+" ",1),M,(0,a._)("small",N,(0,o.zw)(new Date(t.date).toLocaleString()),1)])])])])])])])])))),128))])])])]))])])}var Q=s(9314),R={name:"commentsSec",props:["urlPrefix"],data(){return{commentData:void 0,comment:"",isLogin:void 0,status:{updating:!1,sendingComment:!1}}},methods:{getComments(){let t=null;Q.h.get(`${this.urlPrefix}/comments/${this.$route.params.id}`,{},(e=>{t=e.data;for(let s in t.support)Q.h.post("data/getUser",{id:t.support[s].author},(e=>{t.support[s].author=e.data.name,this.commentData=t,this.status.updating=!0,this.status.updating=!1}),(t=>{console.error(t)}));for(let s in t.else)Q.h.post("data/getUser",{id:t.else[s].author},(e=>{t.else[s].author=e.data.name,this.commentData=t,this.status.updating=!0,this.status.updating=!1}),(t=>{console.error(t)}))}),(t=>{console.error(t)}))},supportComment(){this.status.sendingComment=!0,Q.h.post(`${this.urlPrefix}/commentSupport/${this.$route.params.id}`,{contents:this.comment},(()=>{this.getComments()}),(t=>{403==t.response.status?this.emitter.emit("callLoginShow"):401==t.response.status?alert("管理員不可參與！"):console.error(t)})),this.comment="",this.status.sendingComment=!1},elseComment(){this.status.sendingComment=!0,Q.h.post(`${this.urlPrefix}/commentElse/${this.$route.params.id}`,{contents:this.comment},(()=>{this.getComments()}),(t=>{401==t.response.status?alert("管理員不可參與！"):console.error(t)})),this.comment="",this.status.sendingComment=!1}},created(){this.getComments(),Q.h.post("accounts/status",{},(t=>{0==t.data.status?this.isLogin=!1:this.isLogin=!0}),(t=>{console.error(t)}))}},T=s(89);const X=(0,T.Z)(R,[["render",O]]);var tt=X},5971:function(t,e,s){s.r(e),s.d(e,{default:function(){return O}});var a=s(3396),i=s(7139);const o={key:0},r=(0,a._)("div",{class:"spinner-border text-primary",style:{height:"2em","margin-left":"calc(50vw - 2em)"},role:"status"},null,-1),n=[r],l={key:1},d={key:0,style:{padding:"1em"}},p={style:{color:"var(--bs-gray-700)"}},u={class:"text-end",style:{"border-width":"44px"}},m={key:0},c=(0,a._)("span",null,"已附議",-1),g={style:{color:"var(--bs-blue)","font-size":"24px"}},h=(0,a._)("span",null,"(尚須",-1),b={style:{color:"var(--bs-blue)","font-size":"24px"}},y=(0,a._)("span",null,"份)",-1),v={key:1},w=(0,a._)("span",null,"已附議",-1),_={style:{color:"var(--bs-blue)","font-size":"24px"}},D=(0,a._)("span",null,"人",-1),x=(0,a._)("div",null,[(0,a._)("span",{style:{color:"var(--bs-blue)","font-size":"24px"}},"已達到目標50份")],-1),k={key:2},f=(0,a._)("span",{style:{color:"var(--bs-blue)","font-size":"24px"}},"附議已截止",-1),C=[f],z={key:3},S=(0,a._)("span",null,"剩餘",-1),$={style:{color:"var(--bs-blue)","font-size":"24px"}},L=(0,a._)("span",null,"天",-1),U={style:{"max-width":"calc(100vw)","word-break":"break-all"}},q=(0,a._)("h4",null,"目的",-1),P={style:{"white-space":"pre-wrap"}},Z=(0,a._)("h4",null,"簡介",-1),H={style:{"white-space":"pre-wrap"}},Y={class:"text-center"},j={key:0,class:"btn btn-secondary center",disabled:""},E={key:1,class:"btn btn-secondary center",type:"button",disabled:""},K={key:2,class:"btn btn-primary center",type:"button",disabled:""},V=(0,a._)("div",{class:"spinner-border text-white",role:"status"},null,-1),W=[V],A={key:3},B={key:1,class:"btn btn-secondary center",type:"button",disabled:""};function F(t,e,s,r,f,V){const F=(0,a.up)("commentSec");return(0,a.wg)(),(0,a.iD)(a.HY,null,[void 0==f.cardData?((0,a.wg)(),(0,a.iD)("div",o,n)):((0,a.wg)(),(0,a.iD)("div",l,[0==f.status.updating?((0,a.wg)(),(0,a.iD)("div",d,[(0,a._)("h3",null,(0,i.zw)(f.cardData.title),1),(0,a._)("h6",p,[(0,a.Uk)("作者："),(0,a._)("span",null,(0,i.zw)(f.cardData.proposer),1)]),(0,a._)("div",u,[f.cardData.num<50?((0,a.wg)(),(0,a.iD)("div",m,[c,(0,a._)("span",g,(0,i.zw)(f.cardData.num),1),h,(0,a._)("span",b,(0,i.zw)(50-f.cardData.num),1),y])):((0,a.wg)(),(0,a.iD)("div",v,[(0,a._)("div",null,[w,(0,a._)("span",_,(0,i.zw)(f.cardData.num),1),D]),x])),(new Date).getDate()-new Date(f.cardData.date).getDate()>=30?((0,a.wg)(),(0,a.iD)("div",k,C)):((0,a.wg)(),(0,a.iD)("div",z,[S,(0,a._)("span",$,(0,i.zw)(30-((new Date).getDate()-new Date(f.cardData.date).getDate())),1),L]))]),(0,a._)("div",U,[q,(0,a._)("span",P,(0,i.zw)(f.cardData.purpose),1),Z,(0,a._)("span",H,(0,i.zw)(f.cardData.details),1),(0,a._)("div",Y,[(new Date).getDate()-new Date(f.cardData.date).getDate()>=30?((0,a.wg)(),(0,a.iD)("button",j,"附議已截止")):"adm"==f.isSupported?((0,a.wg)(),(0,a.iD)("button",E,"管理員不可參與")):void 0==f.isSupported?((0,a.wg)(),(0,a.iD)("button",K,W)):((0,a.wg)(),(0,a.iD)("div",A,[0==f.isSupported?((0,a.wg)(),(0,a.iD)("button",{key:0,class:"btn btn-primary center",type:"button",onClick:e[0]||(e[0]=(...t)=>V.support&&V.support(...t))},"我要附議")):1==f.isSupported?((0,a.wg)(),(0,a.iD)("button",B,"已附議")):(0,a.kq)("",!0)]))])])])):(0,a.kq)("",!0)])),(0,a.Wm)(F,{urlPrefix:"propose"})],64)}s(7658);var G=s(9314),I=s(4564),J={components:{commentSec:I.Z},name:"proposeDetails",data(){return{cardData:void 0,isSupported:void 0,status:{updating:!1}}},methods:{support(){G.h.post(`propose/support/${this.$route.params.id}`,{},(t=>{1==t.data.status?(this.isSupported=!0,this.getDetails()):this.isSupported=!0}),(t=>{403==t.response.status?this.emitter.emit("callLoginShow"):401==t.response.status?alert("管理員不可參與！"):console.error(t)}))},getDetails(){G.h.get(`propose/details/${this.$route.params.id}`,{},(t=>{if(null!=t.data){let e=t.data;G.h.post("data/getUser",{id:e.proposer},(t=>{e.proposer=t.data.name,this.cardData=e,this.$route.meta.title=e.title,document.title=this.$route.meta.title,this.status.updating=!0,this.status.updating=!1}),(t=>{console.error(t)}))}else this.$router.push({name:"Error404",params:{status:404}})}),(t=>{console.error(t)}))}},created(){this.getDetails(),G.h.get(`propose/supportStatus/${this.$route.params.id}`,{},(t=>{1==t.data.status?this.isSupported=!0:0==t.data.status&&(this.isSupported=!1)}),(t=>{403==t.response.status?this.isSupported=!1:401==t.response.status?this.isSupported="adm":console.error(t)}))}},M=s(89);const N=(0,M.Z)(J,[["render",F]]);var O=N}}]);
//# sourceMappingURL=971.8e036f1e.js.map